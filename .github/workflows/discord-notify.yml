name: Discord PR Notification

on:
  pull_request:
    types: [opened, reopened, closed]

jobs:
  notify_discord:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set notification message
        id: message
        run: |
          if [[ "${{ github.event.action }}" == "closed" && "${{ github.event.pull_request.merged }}" == "true" ]]; then
            echo "emoji=üéâ" >> $GITHUB_OUTPUT
            echo "status=Î®∏ÏßÄÎêòÏóàÏäµÎãàÎã§" >> $GITHUB_OUTPUT
          elif [[ "${{ github.event.action }}" == "closed" ]]; then
            echo "emoji=‚ùå" >> $GITHUB_OUTPUT
            echo "status=Îã´ÌòîÏäµÎãàÎã§" >> $GITHUB_OUTPUT
          else
            echo "emoji=üÜï" >> $GITHUB_OUTPUT
            echo "status=Ïó¥Î†∏ÏäµÎãàÎã§" >> $GITHUB_OUTPUT
          fi

      - name: Discord Notification
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_PR_WEBHOOK }}
          DISCORD_USERNAME: GitHub
          DISCORD_AVATAR: https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png
        uses: Ilshidur/action-discord@master
        with:
          args: |
            ${{ steps.message.outputs.emoji }} PRÏù¥ ${{ steps.message.outputs.status }}! <@${{ secrets.DISCORD_ID_1 }}> <@${{ secrets.DISCORD_ID_2 }}>
            PR: ${{ github.event.pull_request.html_url }}
            ÏûëÏÑ±Ïûê: ${{ github.event.pull_request.user.login }}
            Ï†úÎ™©: ${{ github.event.pull_request.title }}

